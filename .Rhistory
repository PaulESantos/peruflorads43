dplyr::select(categoria,
accepted_name = tnrs_especies,
accepted_family = tnrs_familia) |>
dplyr::distinct()
# -------------------------------------------------------------------------
ds_043_2006_ag <- ds_df |>
dplyr::select(categoria,
accepted_name = tnrs_especies,
accepted_family = tnrs_familia) |>
dplyr::distinct() |>
as.data.frame()
ds_043_2006_ag
ds_043_2006_ag |>
save(file = "data/ds_043_2006_ag.rda")
ds_043_2006_ag |>  head()
devtools::document()
devtools::check()
devtools::load_all()
peruflorads43::ds_043_2006_ag |>  head()
peruflorads43::tab_ds43_2006 |>  head()
devtools::document()
devtools::check()
usethis::use_r("search_ds043")
devtools::load_all()
#' names listed in the 'Categorizacion de Especies Amenazadas de Flora Silvestre'.
#' The second value, "P_updated_name," provides a fuzzy matching of
#' species names. If a species name is not listed in the catalogue, the third value
#' returned will be an empty string.
#'
#' @export
#'
#' @examples
#' \dontrun{
# Search for multiple species vector
splist <- c("Euterpe precatoria var. precatorio",
"Welfia alfredi",
"Hibiscus abelmoschus var. betulifolius")
get_perutimber_data(splist)
#' names listed in the 'Categorizacion de Especies Amenazadas de Flora Silvestre'.
#' The second value, "P_updated_name," provides a fuzzy matching of
#' species names. If a species name is not listed in the catalogue, the third value
#' returned will be an empty string.
#'
#' @export
#'
#' @examples
#' \dontrun{
# Search for multiple species vector
splist <- c("Euterpe precatoria var. precatorio",
"Welfia alfredi",
"Welfia alfredi",
get_perutimber_data(splist)
)))
"Hibiscus abelmoschus var. betulifolius")
splist <- c("Euterpe precatoria var. precatorio",
splist <- c("Euterpe precatoria var. precatorio",
)))
splist <- c("Euterpe precatoria var. precatorio",
"Welfia alfredi",
"Hibiscus abelmoschus var. betulifolius")
result <- search_sps(splist = splist, max_distance = max_distance)
compara <- result$accepted_name == result$name_submitted
output_result <- vector()
output_result[i] <- "Present"
for(i in seq_along(splist)){
if( isTRUE(compara[i] == TRUE)){
output_result[i] <- "Present"
}
else if(isTRUE(compara[i] == FALSE)){
output_result[i]<- "P_updated_name"
}
else if(is.na(compara[i])){
output_result[i] <- ""
}
}
(output_result)
"Matucana haynei")
splist <- c("Cleistocactus clavispinus",
"Welfia alfredi",
"Matucana haynei")
result <- search_sps(splist = splist, max_distance = max_distance)
compara <- result$accepted_name == result$name_submitted
output_result <- vector()
for(i in seq_along(splist)){
if( isTRUE(compara[i] == TRUE)){
output_result[i] <- "Present"
}
else if(isTRUE(compara[i] == FALSE)){
output_result[i]<- "P_updated_name"
}
else if(is.na(compara[i])){
output_result[i] <- ""
}
}
(output_result)
result <- search_sps(splist = c("Cleistocactus clavispinus",
"Welfia alfredi",
"Matucana hayneii"), max_distance = max_distance)
compara <- result$accepted_name == result$name_submitted
output_result <- vector()
for(i in seq_along(splist)){
if( isTRUE(compara[i] == TRUE)){
output_result[i] <- "Present"
}
else if(isTRUE(compara[i] == FALSE)){
output_result[i]<- "P_updated_name"
}
else if(is.na(compara[i])){
output_result[i] <- ""
}
}
(output_result)
usethis::use_r("category_ds043_2006")
sps_result <- search_sps(splist = splist, max_distance = max_distance)
submitted_names = sps_result[!is.na(sps_result$accepted_name), 1]#,
names_accepted <-  sps_result[!is.na(sps_result$accepted_name), 8]#
output_matrix <- matrix(nrow = length(submitted_names), ncol = 10 )
devtools::document()
devtools::check()
devtools::load_all()
splist <- c("Cleistocactus clavispinus",
"Welfia alfredi",
"Matucana haynei")
category_ds043_2006(splist)
devtools::load_all()
category_ds043_2006(splist)
splist <- c("Cleistocactus clavispinus",
"Welfia alfredi",
"Matucana haynei")
category_ds043_2006(splist)
search_ds043(splist)
category_ds043_2006(splist)
devtools::document()
devtools::check()
devtools::check()
devtools::check()
devtools::document()
devtools::check()
splist <- c("Cleistocactus clavispinus",
"Welfia alfredi",
"Matucana haynei")
category_ds043_2006(splist)
search_ds043(splist)
category_ds043_2006(splist)
devtools::load_all()
splist <- c("Cleistocactus clavispinus",
"Welfia alfredi",
"Matucana haynei")
sps_result <- search_sps(splist = splist, max_distance = max_distance)
max_distance = 0.2
sps_result <- search_sps(splist = splist, max_distance = max_distance)
sps_result
submitted_names = sps_result[!is.na(sps_result$accepted_name), 1]#,
names_accepted <-  sps_result[!is.na(sps_result$accepted_name), 8]#
submitted_names
names_accepted <-  sps_result[!is.na(sps_result$accepted_name), 8]#
names_accepted
sps_result
names_accepted
sps_result
sps_result[!is.na(sps_result$accepted_name), 1]
submitted_names = sps_result[!is.na(sps_result$name_submitted), 1]#,
submitted_names
names_accepted <-  sps_result[!is.na(sps_result$accepted_name), 8]#
names_accepted
names_accepted <-  sps_result[sps_result$accepted_name, 8]#
names_accepted
sps_result
sps_result$accepted_name
sps_result[sps_result$accepted_name, 8]
names_accepted <-  sps_result[, 8]#
names_accepted
submitted_names
names_accepted
output_matrix <- matrix(nrow = length(submitted_names), ncol = 10 )
output_matrix
sps_x <- as.matrix(peruflorads43::ds_043_2006_ag[peruflorads43::ds_043_2006_ag$accepted_name == names_accepted[1],])
sps_x
sps_x <- as.matrix(peruflorads43::ds_043_2006_ag[peruflorads43::ds_043_2006_ag$accepted_name == names_accepted[2],])
sps_x
sps_x
output_matrix <- matrix(nrow = length(submitted_names), ncol = 3 )
output_matrix
sps_x <- as.matrix(peruflorads43::ds_043_2006_ag[peruflorads43::ds_043_2006_ag$accepted_name == names_accepted[1],])
sps_x
output_matrix[1,] <- sps_x
output_matrix
sps_x <- as.matrix(peruflorads43::ds_043_2006_ag[peruflorads43::ds_043_2006_ag$accepted_name == names_accepted[2],])
sps_x
output_matrix[2,] <- sps_x
output_matrix
sps_x <- as.matrix(peruflorads43::ds_043_2006_ag[peruflorads43::ds_043_2006_ag$accepted_name == names_accepted[3],])
output_matrix[3,] <- sps_x
output_matrix
sps_x <- cbind(name_submitted[1],
as.matrix(peruflorads43::ds_043_2006_ag[peruflorads43::ds_043_2006_ag$accepted_name == names_accepted[1],]))
sps_x
sps_x <- cbind(matrix(name_submitted[1], ncol = 1),
as.matrix(peruflorads43::ds_043_2006_ag[peruflorads43::ds_043_2006_ag$accepted_name == names_accepted[1],]))
sps_x
sps_x <- cbind(matrix(submitted_names[1], ncol = 1),
as.matrix(peruflorads43::ds_043_2006_ag[peruflorads43::ds_043_2006_ag$accepted_name == names_accepted[1],]))
sps_x
cbind(matrix(submitted_names[i], ncol = 1),
matrix(rep(NA_character_, 3), ncol = 3))
cbind(matrix(submitted_names[1], ncol = 1),
matrix(rep(NA_character_, 3), ncol = 3))
sps_result <- search_sps(splist = splist, max_distance = max_distance)
sps_result
submitted_names = sps_result[!is.na(sps_result$name_submitted), 1]#,
submitted_names
names_accepted <-  sps_result[, 8]#
names_accepted
output_matrix <- matrix(nrow = length(submitted_names), ncol = 4 )
output_matrix
for (i in seq_along(names_accepted)) {
if(!is.na(names_accepted)){
sps_x <- cbind(matrix(submitted_names[i], ncol = 1),
as.matrix(peruflorads43::ds_043_2006_ag[peruflorads43::ds_043_2006_ag$accepted_name == names_accepted[i],]))
output_matrix[i,] <- sps_x
}
else {
sps_x <- cbind(matrix(submitted_names[i], ncol = 1),
matrix(rep(NA_character_, 3), ncol = 3))
output_matrix[i,] <- sps_x
}
}
output_matrix
sps_result <- search_sps(splist = splist, max_distance = max_distance)
sps_result
submitted_names = sps_result[!is.na(sps_result$name_submitted), 1]#,
submitted_names
names_accepted <-  sps_result[, 8]#
names_accepted
output_matrix <- matrix(nrow = length(submitted_names), ncol = 4 )
output_matrix
for (i in seq_along(names_accepted)) {
if(is.na(names_accepted)){
sps_x <- cbind(matrix(submitted_names[i], ncol = 1),
matrix(rep(NA_character_, 3), ncol = 3))
output_matrix[i,] <- sps_x
}
else {
sps_x <- cbind(matrix(submitted_names[i], ncol = 1),
as.matrix(peruflorads43::ds_043_2006_ag[peruflorads43::ds_043_2006_ag$accepted_name == names_accepted[i],]))
output_matrix[i,] <- sps_x
}
}
output_matrix
output_matrix <- matrix(nrow = length(submitted_names), ncol = 4 )
output_matrix
for (i in seq_along(names_accepted)) {
if(any(is.na(names_accepted))){
sps_x <- cbind(matrix(submitted_names[i], ncol = 1),
matrix(rep(NA_character_, 3), ncol = 3))
output_matrix[i,] <- sps_x
}
else {
sps_x <- cbind(matrix(submitted_names[i], ncol = 1),
as.matrix(peruflorads43::ds_043_2006_ag[peruflorads43::ds_043_2006_ag$accepted_name == names_accepted[i],]))
output_matrix[i,] <- sps_x
}
}
output_matrix
output_matrix
for (i in seq_along(names_accepted)) {
if(any(!is.na(names_accepted))){
sps_x <- cbind(matrix(submitted_names[i], ncol = 1),
matrix(rep(NA_character_, 3), ncol = 3))
output_matrix[i,] <- sps_x
}
else {
sps_x <- cbind(matrix(submitted_names[i], ncol = 1),
as.matrix(peruflorads43::ds_043_2006_ag[peruflorads43::ds_043_2006_ag$accepted_name == names_accepted[i],]))
output_matrix[i,] <- sps_x
}
}
output_matrix
colnames(output_matrix) <- c("name_submitted", "categoria", "accepted_name", "accepted_family")
output_matrix
result <- cbind(data.frame(names_submitted = submitted_names),
output_matrix)
result
result
output_matrix <- matrix(nrow = length(submitted_names), ncol = 4 )
output_matrix
for (i in seq_along(names_accepted)) {
if(any(!is.na(names_accepted))){
sps_x <- cbind(matrix(submitted_names[i], ncol = 1),
as.matrix(peruflorads43::ds_043_2006_ag[peruflorads43::ds_043_2006_ag$accepted_name == names_accepted[i],]))
output_matrix[i,] <- sps_x
}
else {
sps_x <- cbind(matrix(submitted_names[i], ncol = 1),
matrix(rep(NA_character_, 3), ncol = 3))
output_matrix[i,] <- sps_x
}
}
output_matrix
any(!is.na(names_accepted))
output_matrix <- matrix(nrow = length(submitted_names), ncol = 4 )
output_matrix
for (i in seq_along(names_accepted)) {
if(!is.na(names_accepted[i])){
sps_x <- cbind(matrix(submitted_names[i], ncol = 1),
as.matrix(peruflorads43::ds_043_2006_ag[peruflorads43::ds_043_2006_ag$accepted_name == names_accepted[i],]))
output_matrix[i,] <- sps_x
}
else {
sps_x <- cbind(matrix(submitted_names[i], ncol = 1),
matrix(rep(NA_character_, 3), ncol = 3))
output_matrix[i,] <- sps_x
}
}
output_matrix
colnames(output_matrix) <- c("name_submitted", "categoria", "accepted_name", "accepted_family")
output_matrix
devtools::document()
devtools::check()
devtools::check()
devtools::check()
devtools::load_all()
devtools::load_all()
devtools::load_all()
splist <- c("Cleistocactus clavispinus",
"Welfia alfredi",
"Matucana haynei")
category_ds043_2006(splist)
search_ds043(splist)
splist <- c("Cleistocactus clavispinus",
"Welfia alfredi",
"Matucana hayneii")
category_ds043_2006(splist)
search_ds043(splist)
o
devtools::load_all()
splist <- c("Cleistocactus clavispinus",
"Welfia alfredi",
"Matucana hayneii")
category_ds043_2006(splist)
search_ds043(splist)
category_ds043_2006(splist) |>
dplyr::as_tibble()
devtools::load_all()
splist <- c("Cleistocactus clavispinus",
"Welfia alfredi",
"Matucana hayneii")
category_ds043_2006(splist) |>
dplyr::as_tibble()
search_ds043(splist)
usethis::use_test("category_ds043_2006")
search_ds043(splist)
category_ds043_2006(splist)
usethis::use_test("search_ds043")
search_ds043(splist)
devtools::load_all()
splist <- c("Cleistocactus clavispinus",
"Welfia alfredi",
"Matucana hayneii")
devtools::document()
devtools::check()
devtools::check()
devtools::check()
pak::pak("PaulEsantos/peruflorads43")
df <- readxl::read_xlsx("data/data_ds043_2006.xlsx")
df <- readxl::read_xlsx("data/data_ds043_2006.xlsx")
df
df |>
names()
df |>
filter(fuente == "original")
library(tidyverse)
df |> distinct(fuente)
df |>
filter(fuente == "original")
df |>
filter(fuente == "original") |>
filter(!str_detect(especie, "forma"))
df |>
filter(fuente == "original") |>
filter(!str_detect(especie, "forma")) |>
distinct()
df |>
filter(fuente == "original") |>
filter(!str_detect(especie, "forma")) |>
distinct() |>
filter(str_detect(especie, "Bisho"))
df |>
filter(fuente == "original") |>
filter(!str_detect(especie, "forma")) |>
select(especies_raw, tnrs_especies)
df |>
filter(fuente == "original") |>
filter(!str_detect(especie, "forma")) |>
select(especies_raw, tnrs_especies) |>
group_by(tnrs_especies) |>
add_count()
df |>
filter(fuente == "original") |>
filter(!str_detect(especie, "forma")) |>
select(especies_raw, tnrs_especies) |>
group_by(tnrs_especies) |>
add_count() |>
filter(n > 1)
df |>
# filter(fuente == "original") |>
filter(!str_detect(especie, "forma")) |>
select(especies_raw, tnrs_especies) |>
group_by(tnrs_especies) |>
add_count() |>
filter(n > 1)
df |>
filter(fuente == "original") |>
filter(!str_detect(especie, "forma")) |>
select(especies_raw, tnrs_especies) |>
group_by(tnrs_especies) |>
add_count() |>
filter(n > 1)
tibble::tribble(
~species_name, ~accepted_name,
"Ceroxylon crispum",                  "Ceroxylon vogelianum",
"Ceroxylum verriculosum",             "Ceroxylon vogelianum",
"Comparettia coccinea",               "Comparettia coccinea",
"Comparettia peruviana",              "Comparettia coccinea",
"Geonoma undata",                     "Geonoma undata",
"Geonoma weberbaueri",                "Geonoma undata",
"Lycaste ciliata",                    "Lycaste ciliata",
"Lycaste fimbriata",                  "Lycaste ciliata",
"Mila caespitosa subsp. caespitosa",  "Mila caespitosa",
"Mila caespitosa subsp. densiseta",   "Mila caespitosa"
)
df |>
select(tnrs_especies) |>
distinct()
df |>
select(tnrs_especies)
df |>
select(tnrs_especies) |>
distinct()
df |>
filter(fuente == "original") |>
filter(str_detect(especie, "forma"))
df |>
filter(fuente == "original") |>
filter(str_detect(especie, "forma")) |>
select(especies_raw)
df |>
filter(fuente == "original") |>
filter(str_detect(especie, "forma")) |>
select(especie)
df |>
filter(fuente == "original") |>
filter(str_detect(especie, "forma")) |>
select(especie, tnrs_especies)
df |>
filter(fuente == "original") |>
filter(str_detect(especie, "forma")) |>
select(especie, tnrs_especies)
df |>
filter(fuente == "original") |>
filter(str_detect(especie, "forma")) |>
select( tnrs_especies)
df |>
filter(fuente == "original") |>
filter(str_detect(especie, "forma")) |>
select( tnrs_especies, taxonomic_status)
df |>
filter(!is.na(comentarios))
df |>
filter(!is.na(comentarios)) |>
select(tnrs_especies, comentarios)
df |>
filter(!is.na(comentarios)) |>
select(tnrs_especies, comentarios)
df |>
filter(!is.na(comentarios)) |>
select(tnrs_especies,accepted_name_rank ,comentarios)
df |>
filter(!is.na(comentarios)) |>
select(tnrs_especies,accepted_name_rank , taxonomic_status,comentarios)
splist <- c("Cleistocactus clavispinus",
"Welfia alfredi",
"Matucana hayneii")
search_ds043(splist = splist)
library(peruflorads43)
splist <- c("Cleistocactus clavispinus",
"Welfia alfredi",
"Matucana hayneii")
category_ds043_2006(splist) |>
dplyr::as_tibble()
search_ds043(splist)
search_ds043(splist)
df <- data(splist = splist)
df
df <- data.frame(splist = splist)
df
devtools::document()
devtools::check()
devtools::document()
devtools::document()
devtools::check()
citation()
citation("peruflorads43")
citation("peruflorads43")
citation("peruflorads43")
citation("peruflorads43")
aa <- citation("peruflorads43")
aa
aa |>  class()
aa[1]
aa[2]
aa
